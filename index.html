<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Painel Administrativo NEXUS V12" />

    <title>NEXUS V12 • Painel Administrativo</title>

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />

    <!-- Font Awesome -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
          crossorigin="anonymous"
          referrerpolicy="no-referrer" />
</head>

<body>

<!-- ================= LOGIN ================= -->
<section id="login-screen" class="screen active">
    <div class="login-card">
        <header>
            <h1>NEXUS <span>V12</span></h1>
            <p>Painel de Controle</p>
        </header>

        <form id="login-form">
            <div class="input-group">
                <input type="email" id="email-login" required />
                <label for="email-login">E-mail</label>
            </div>

            <div class="input-group">
                <input type="password" id="pass-login" required />
                <label for="pass-login">Senha</label>
            </div>

            <button type="submit" class="btn-main full">
                <span>ENTRAR</span>
                <i class="fa fa-arrow-right"></i>
            </button>

            <small id="auth-status"></small>
        </form>
    </div>
</section>


<!-- ================= APP ================= -->
<div id="app" class="hidden">

    <!-- SIDEBAR -->
    <aside id="sidebar">
        <div class="logo">NEXUS <span>V12</span></div>

        <nav>
            <button class="nav-item active" data-tab="estoque">
                <i class="fa fa-car"></i> Estoque
            </button>

            <button class="nav-item" data-tab="crm">
                <i class="fa fa-users"></i> CRM
            </button>

            <button class="nav-item" data-tab="vendedores">
                <i class="fa fa-user-tie"></i> Vendedores
            </button>

            <button class="nav-item" data-tab="config">
                <i class="fa fa-cog"></i> Configurações
            </button>
        </nav>

        <button id="btn-logout" class="logout-btn">
            <i class="fa fa-sign-out-alt"></i> Sair
        </button>
    </aside>


    <!-- MAIN -->
    <main id="content">

        <!-- ====== ESTOQUE ====== -->
        <section id="estoque" class="tab-content active">

            <div class="section-header">
                <h2>Gestão de Estoque</h2>
                <div class="stats">
                    <span id="total-carros">0 veículos</span>
                </div>
            </div>

            <div class="glass-box">
                <h3 id="form-title">Novo Veículo</h3>

                <form id="form-veiculo">
                    <input type="hidden" id="edit-carro-id" />

                    <div class="form-grid">
                        <input type="text" id="marca" placeholder="Marca" required />
                        <input type="text" id="modelo" placeholder="Modelo" required />
                        <input type="number" id="preco" placeholder="Preço (R$)" required />
                        <input type="text" id="ano" placeholder="Ano" required />
                        <input type="number" id="km" placeholder="KM" />

                        <select id="cambio">
                            <option value="Automático">Automático</option>
                            <option value="Manual">Manual</option>
                        </select>

                        <select id="status-carro">
                            <option value="disponivel">Disponível</option>
                            <option value="vendido">Vendido</option>
                        </select>
                    </div>

                    <textarea id="descricao" rows="3"
                              placeholder="Descrição do veículo..."></textarea>

                    <!-- Upload -->
                    <div class="photo-uploader">
                        <label class="slot">
                            <input type="file" data-index="0" hidden />
                            <i class="fa fa-camera"></i>
                        </label>

                        <label class="slot">
                            <input type="file" data-index="1" hidden />
                            <i class="fa fa-plus"></i>
                        </label>

                        <label class="slot">
                            <input type="file" data-index="2" hidden />
                            <i class="fa fa-plus"></i>
                        </label>
                    </div>

                    <button type="submit" class="btn-main">
                        SALVAR VEÍCULO
                    </button>
                </form>
            </div>

            <div class="glass-box">
                <div class="list-header">
                    <h3>Veículos no Pátio</h3>
                    <input type="text" id="buscar-carro"
                           placeholder="Buscar veículo..." />
                </div>

                <div id="lista-estoque-admin"></div>
            </div>
        </section>


        <!-- ====== VENDEDORES ====== -->
        <section id="vendedores" class="tab-content">

            <div class="glass-box">
                <h3>Cadastrar Vendedor</h3>

                <form id="form-vendedor">
                    <div class="form-grid">
                        <input type="text" id="nome-vendedor"
                               placeholder="Nome Completo" required />
                        <input type="text" id="whatsapp-vendedor"
                               placeholder="WhatsApp" required />
                        <input type="email" id="email-vendedor"
                               placeholder="E-mail de acesso" required />
                    </div>

                    <button type="submit" class="btn-main">
                        CADASTRAR VENDEDOR
                    </button>
                </form>
            </div>

            <div class="glass-box">
                <h3>Equipe Ativa</h3>
                <div id="lista-vendedores"></div>
            </div>
        </section>


        <!-- ====== CRM ====== -->
        <section id="crm" class="tab-content">

            <header class="section-header">
                <h2>CRM • Funil de Vendas</h2>
            </header>

            <div class="kanban-board">
                <div class="kanban-col" data-status="novo">
                    <h4>Novos</h4>
                    <div class="kanban-cards"></div>
                </div>

                <div class="kanban-col" data-status="contato">
                    <h4>Contato</h4>
                    <div class="kanban-cards"></div>
                </div>

                <div class="kanban-col" data-status="visita">
                    <h4>Visita</h4>
                    <div class="kanban-cards"></div>
                </div>

                <div class="kanban-col" data-status="fechado">
                    <h4>Fechado</h4>
                    <div class="kanban-cards"></div>
                </div>
            </div>
        </section>


        <!-- ====== CONFIG ====== -->
        <section id="config" class="tab-content">

            <div class="glass-box">
                <h3>Portal da Loja</h3>
                <p>Compartilhe seu estoque com seus clientes.</p>

                <button id="btn-copiar-portal" class="btn-main">
                    <i class="fa fa-link"></i>
                    Copiar Link do Portal
                </button>
            </div>

        </section>

    </main>
</div>


<!-- ================= SCRIPT ================= -->
<script type="module">

/* ================= LOGIN ================= */

document.getElementById("login-form")
    .addEventListener("submit", (e) => {
        e.preventDefault();
        fazerLogin(); // sua função existente
    });


/* ================= NAVEGAÇÃO ================= */

document.querySelectorAll(".nav-item").forEach(btn => {
    btn.addEventListener("click", () => {
        nav(btn.dataset.tab); // sua função existente
    });
});


/* ================= LOGOUT ================= */

document.getElementById("btn-logout")
    .addEventListener("click", handleLogout);


/* ================= FORM VEÍCULO ================= */

document.getElementById("form-veiculo")
    .addEventListener("submit", (e) => {
        e.preventDefault();
        salvarVeiculo(); // sua função existente
    });


/* ================= FORM VENDEDOR ================= */

document.getElementById("form-vendedor")
    .addEventListener("submit", (e) => {
        e.preventDefault();
        salvarVendedor(); // sua função existente
    });


/* ================= COPIAR PORTAL ================= */

document.getElementById("btn-copiar-portal")
    .addEventListener("click", copiarLinkPortal);


/* ================= BUSCA VEÍCULO ================= */

document.getElementById("buscar-carro")
    .addEventListener("input", function () {

        const termo = this.value.toLowerCase();
        const cards = document.querySelectorAll("#lista-estoque-admin .car-card");

        cards.forEach(card => {
            const texto = card.innerText.toLowerCase();
            card.style.display =
                texto.includes(termo) ? "block" : "none";
        });
    });


/* ================= UPLOAD FOTO ================= */

document.querySelectorAll(".photo-uploader input[type=file]")
    .forEach(input => {

        input.addEventListener("change", function () {
            const index = this.dataset.index;
            handlePhoto(this, null, index); // sua função existente
        });

    });

</script>

</body>
</html>
